<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Selecting and assinging ProTrackR2 objects • ProTrackR2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selecting and assinging ProTrackR2 objects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ProTrackR2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.6.0004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/effect_commands.html">Effect commands</a></li>
    <li><a class="dropdown-item" href="../articles/ProTrackR_vs_ProTrackR2.html">ProTrackR vs ProTrackR2</a></li>
    <li><a class="dropdown-item" href="../articles/s3class.html">ProTrackR2 S3 class objects</a></li>
    <li><a class="dropdown-item" href="../articles/sel_assign.html">Selecting and assinging ProTrackR2 objects</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pepijn-devries/ProTrackR2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Selecting and assinging ProTrackR2 objects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pepijn-devries/ProTrackR2/blob/master/vignettes/sel_assign.Rmd" class="external-link"><code>vignettes/sel_assign.Rmd</code></a></small>
      <div class="d-none name"><code>sel_assign.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes how to select elements from ProTrackR2 module
objects and how to replace them. In order to best understand this, it is
necessary to understand how objects are organised in the ProTrackR2
package. Please read <code><a href="../articles/s3class.html">vignette("s3class")</a></code> first, or use it
for reference when reading the vignette at hand. Before we continue, we
start the session by loading a module file.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pepijn-devries.github.io/ProTrackR2/">ProTrackR2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mod_io.html">pt2_read_mod</a></span><span class="op">(</span><span class="fu"><a href="../reference/pt2_demo.html">pt2_demo</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="selecting-lists-from-modules">Selecting lists from modules<a class="anchor" aria-label="anchor" href="#selecting-lists-from-modules"></a>
</h2>
<p>There are two important lists of objects contained in ProTracker
modules. The first is a list of patterns (<code>pt2patlist</code>),
which can be obtained as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">patterns</span></span>
<span><span class="co">#&gt; pattern list [n=4]</span></span>
<span><span class="co">## which is identical to</span></span>
<span><span class="va">mod</span><span class="op">[[</span><span class="st">"patterns"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; pattern list [n=4]</span></span>
<span><span class="co">## which is identical to</span></span>
<span><span class="va">mod</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; pattern list [n=4]</span></span></code></pre></div>
<p>It returns a list of patterns and inherits the class
<code>pt2patlist</code>, from it you can select one ore more specific
patterns (see below).</p>
<p>The second list you can get from a module is a list of samples
(<code>pt2samplist</code>), which can be obtained as follows.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">samples</span></span>
<span><span class="co">#&gt; sample list [n=31]</span></span>
<span><span class="co">## which is identical to</span></span>
<span><span class="va">mod</span><span class="op">[[</span><span class="st">"samples"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; sample list [n=31]</span></span>
<span><span class="co">## which is identical to</span></span>
<span><span class="va">mod</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; sample list [n=31]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="index-base-one-or-zero">Index base: one or zero?<a class="anchor" aria-label="anchor" href="#index-base-one-or-zero"></a>
</h2>
<p>For vectors and lists, <code>R</code> uses indices starting at 1.
ProTracker modules often use arrays of elements that are starting with
indices at 0 (but alas not consistently for everything). And in some
case ProTracker effect commands refer to such indices (see
<code><a href="../articles/effect_commands.html">vignette("effect_commands")</a></code>). Unfortunately, this is a
source of confusion, for which there exists no ideal solution.</p>
<p>In this package, I’ve tried to implement it as consistent as
possible. Named functions and methods use zero-based indices, whereas
bracket operators (<code>[</code> and <code>[[</code>) use one-based
indices conform <code>R</code> syntax. This is summarised in the table
below.</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Zero-based index
</th>
<th style="text-align:left;">
One-based index
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
<code><a href="../reference/pt2_cell.html">pt2_cell()</a></code>, <code><a href="../reference/pt2_pattern.html">pt2_pattern()</a></code>,
<code><a href="../reference/pt2_sample.html">pt2_sample()</a></code>
</td>
<td style="text-align:left;">
<code>[</code>, <code>[[</code>
</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="selecting-and-replacing-list-elements">Selecting and replacing list elements<a class="anchor" aria-label="anchor" href="#selecting-and-replacing-list-elements"></a>
</h2>
<div class="section level3">
<h3 id="samples">Samples<a class="anchor" aria-label="anchor" href="#samples"></a>
</h3>
<p>Selecting a specific sample from a sample list can be done with the
<code>[[</code>-operator. Note that sample number 5 is empty (consists
of zero samples):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">samples</span><span class="op">[[</span><span class="fl">5L</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "PT2 Sample 'commodore amiga 500' [0]"</span></span>
<span><span class="co">## which is identical to (see the different base of the index)</span></span>
<span><span class="fu"><a href="../reference/pt2_sample.html">pt2_sample</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">4L</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PT2 Sample 'commodore amiga 500' [0]"</span></span></code></pre></div>
<p>In order to replace this sample with sample number 2, you can simply
assign it like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">samples</span><span class="op">[[</span><span class="fl">5L</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">samples</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>After this assignment operation samples 2 and 5 are identical. If you
want to replace multiple samples at once you need to use the
<code>[</code>-operator. The example below shows how to replace samples
5 up to 8 with sample 2:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">samples</span><span class="op">[</span><span class="fl">5L</span><span class="op">:</span><span class="fl">8L</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">samples</span><span class="op">[</span><span class="fl">2L</span><span class="op">]</span></span></code></pre></div>
<p>Single brackets <code>[</code> returns a list
(<code>pt2samplist</code>) with one or more elements. Double brackets
<code>[[</code> return a single element (<code>pt2samp</code>). In
essence, this works the same as with normal <code>list</code>
objects.</p>
</div>
<div class="section level3">
<h3 id="patterns">Patterns<a class="anchor" aria-label="anchor" href="#patterns"></a>
</h3>
<p>For a pattern lists (<code>pt2patlist</code>) selection and
assignment operators are similar to those of sample lists (see above).
Single brackets <code>[</code> returns a list (<code>pt2patlist</code>)
with one or more elements. Double brackets <code>[[</code> return a
single element (<code>pt2pat</code>). In essence, this works the same as
with normal <code>list</code> objects.</p>
<p>The range of pattern indices you can use depends on the maximum index
(+1) registered in the pattern sequence table
(<code>pt2_pattern_table(mod)</code>). In the currently loaded module
there are 4 patterns registered. So to get the fourth pattern table in
the module, you use:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_pattern</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">patterns</span><span class="op">[[</span><span class="fl">4L</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">## which is identical to (see the different base of the index)</span></span>
<span><span class="va">my_pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pt2_pattern.html">pt2_pattern</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">3L</span><span class="op">)</span></span></code></pre></div>
<p>If you attempt to get the fifth table
(<code>mod$patterns[[5]]</code>), you will get an error, since it
doesn’t exist. However, you can append a new pattern table at this
position using the assign operator:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">patterns</span><span class="op">[[</span><span class="fl">5L</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pt2_new_pattern.html">pt2_new_pattern</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This new pattern is also automatically added to the pattern sequence
table:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mod_info.html">pt2_pattern_table</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] 0 0 1 1 2 2 3 3 2 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span></code></pre></div>
<p>You can use the same strategy to copy existing patterns to a new
index:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">patterns</span><span class="op">[[</span><span class="fl">6L</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">patterns</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>In theory ProTracker modules can hold a maximum of 100 pattern
tables. If this limit can be reached depends on available slots in the
pattern sequence table (<code>pt2_pattern_table(mod)</code>). If you try
to create a pattern beyond the maximum of 100 or there are no more room
for additional patterns in the sequence table, you will get an
error.</p>
</div>
<div class="section level3">
<h3 id="cells">Cells<a class="anchor" aria-label="anchor" href="#cells"></a>
</h3>
<p>As explained in <code><a href="../articles/s3class.html">vignette("s3class")</a></code>, a cell (class
<code>pt2cell</code>) is the elementary unit of a pattern table and
specifies which instrument (sample) to play at which note and with which
effect. You can select a range of cells with a <code>[</code>-operator
by referring to a pattern’s row index and its channel (column) index.
The example below selects the first 8 rows from the first channel.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_cells</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">patterns</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1L</span><span class="op">:</span><span class="fl">8L</span>, <span class="fl">1L</span><span class="op">]</span></span></code></pre></div>
<p>The result of this is an object of class <code>pt2celllist</code>. To
select a particular cell from this range you need the double bracket
operator <code>[[</code>. To select the first cell of the eight selected
cells you do the following.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_cells</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">C-3</span><span style="color: #555555;"> </span><span style="color: #00BBBB;">01</span><span style="color: #555555;"> </span><span style="color: #00BB00;">A08</span></span></span>
<span><span class="co">## which is identical to (see the different base of the indices)</span></span>
<span><span class="fu"><a href="../reference/pt2_cell.html">pt2_cell</a></span><span class="op">(</span><span class="fu"><a href="../reference/pt2_pattern.html">pt2_pattern</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">0L</span><span class="op">)</span>, i <span class="op">=</span> <span class="fl">0L</span>, j <span class="op">=</span> <span class="fl">0L</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">C-3</span><span style="color: #555555;"> </span><span style="color: #00BBBB;">01</span><span style="color: #555555;"> </span><span style="color: #00BB00;">A08</span></span></span></code></pre></div>
<p>Remember that we appended an empty pattern at position 5? We can
replace the empty cells in that pattern with the selected cells. The
example below shows how the entire first column is filled with the 8
selected cells (note that the cells are recycled).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">patterns</span><span class="op">[[</span><span class="fl">5L</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1L</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">my_cells</span></span>
<span><span class="co">#&gt; Warning in replace_cells_(x, as.matrix(target_idx), values): Replacement values</span></span>
<span><span class="co">#&gt; are recycled</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pepijn de Vries, Olav Sørensen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
